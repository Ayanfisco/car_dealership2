<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Dashboard Kanban View for Dealership Vehicles -->
    <record id="view_dealership_vehicle_dashboard_kanban" model="ir.ui.view">
        <field name="name">dealership.vehicle.dashboard.kanban</field>
        <field name="model">dealership.vehicle</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_dashboard o_dealership_dashboard" create="0" group_create="0" default_group_by="state">
                <field name="name"/>
                <field name="make_id"/>
                <field name="model_id"/>
                <field name="year"/>
                <field name="color"/>
                <field name="state"/>
                <field name="product_id"/>
                <field name="available_quantity"/>
                
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="o_kanban_record oe_kanban_global_click #{record.state.raw_value == 'available' ? 'o_kanban_card_available' : 'o_kanban_card_sold'}">
                            <div class="o_kanban_content">
                                <!-- Header Section -->
                                <div class="o_kanban_record_top mb16">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <t t-if="record.state.raw_value == 'available'">
                                                <i class="fa fa-car text-success me-2"/>
                                                Available Vehicles
                                            </t>
                                            <t t-if="record.state.raw_value == 'sold'">
                                                <i class="fa fa-check-circle text-warning me-2"/>
                                                Sold Vehicles
                                            </t>
                                        </strong>
                                    </div>
                                    <div class="o_kanban_manage_button_section">
                                        <a class="o_kanban_manage_toggle_button" href="#">
                                            <i class="fa fa-ellipsis-v" role="img" aria-label="Manage" title="Manage"/>
                                        </a>
                                    </div>
                                </div>

                                <!-- Main Stats Section -->
                                <div class="o_kanban_primary_section text-center mb16">
                                    <div t-attf-class="o_primary_value #{record.state.raw_value == 'available' ? 'text-success' : 'text-warning'}">
                                        <t t-if="record.state.raw_value == 'available'">
                                            <span class="o_value">
                                                <field name="available_quantity" widget="integer"/>
                                            </span>
                                        </t>
                                        <t t-if="record.state.raw_value == 'sold'">
                                            <span class="o_value">1</span>
                                        </t>
                                    </div>
                                    <div class="o_secondary_value text-muted">
                                        <t t-if="record.state.raw_value == 'available'">
                                            Units Available
                                        </t>
                                        <t t-if="record.state.raw_value == 'sold'">
                                            Units Sold
                                        </t>
                                    </div>
                                </div>

                                <!-- Vehicle Details Section -->
                                <div class="o_kanban_details">
                                    <div class="row g-0">
                                        <div class="col-6">
                                            <div class="o_kanban_detail_item">
                                                <span class="o_label">Make:</span>
                                                <field name="make_id" class="ms-1"/>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="o_kanban_detail_item">
                                                <span class="o_label">Model:</span>
                                                <field name="model_id" class="ms-1"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row g-0 mt-1">
                                        <div class="col-6">
                                            <div class="o_kanban_detail_item">
                                                <span class="o_label">Year:</span>
                                                <field name="year" class="ms-1"/>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="o_kanban_detail_item">
                                                <span class="o_label">Color:</span>
                                                <field name="color" class="ms-1"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Status Badge -->
                                <div class="o_kanban_footer mt16">
                                    <div class="o_kanban_tags_section">
                                        <field name="state" widget="label_selection" 
                                               options="{'classes': {
                                                   'available': 'success', 
                                                   'sold': 'warning',
                                                   'reserved': 'info',
                                                   'returned': 'secondary'
                                               }}"/>
                                    </div>
                                </div>

                                <!-- Management Panel -->
                                <div class="o_kanban_manage_pane dropdown-menu" role="menu">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-6">
                                                <h5 role="menuitem" aria-haspopup="true" class="o_kanban_card_manage_title">
                                                    <span>Vehicle Actions</span>
                                                </h5>
                                                <div role="menuitem">
                                                    <a type="edit" class="dropdown-item">
                                                        <i class="fa fa-pencil me-2"/>Edit Vehicle
                                                    </a>
                                                </div>
                                                <div role="menuitem">
                                                    <a name="action_view_details" class="dropdown-item">
                                                        <i class="fa fa-eye me-2"/>View Details
                                                    </a>
                                                </div>
                                                <t t-if="record.state.raw_value == 'available'">
                                                    <div role="menuitem">
                                                        <a name="action_mark_sold" class="dropdown-item">
                                                            <i class="fa fa-check me-2"/>Mark as Sold
                                                        </a>
                                                    </div>
                                                </t>
                                            </div>
                                            <div class="col-6">
                                                <h5 role="menuitem" aria-haspopup="true" class="o_kanban_card_manage_title">
                                                    <span>Reports</span>
                                                </h5>
                                                <div role="menuitem">
                                                    <a name="action_vehicle_report" class="dropdown-item">
                                                        <i class="fa fa-file-text-o me-2"/>Vehicle Report
                                                    </a>
                                                </div>
                                                <div role="menuitem">
                                                    <a name="action_inventory_report" class="dropdown-item">
                                                        <i class="fa fa-bar-chart me-2"/>Inventory Report
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Custom CSS for the dashboard -->
    <template id="dealership_dashboard_assets" name="Dealership Dashboard Assets">
        <xpath expr="." position="inside">
            <style type="text/css">
                /* Dashboard Kanban Styles */
                .o_dealership_dashboard .o_kanban_record {
                    margin: 8px;
                    border-radius: 12px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                    transition: all 0.3s ease;
                    border: none;
                    overflow: hidden;
                }

                .o_dealership_dashboard .o_kanban_record:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
                }

                /* Available Vehicles Card */
                .o_kanban_card_available {
                    background: linear-gradient(135deg, #e8f5e8 0%, #f0f9f0 100%);
                    border-left: 4px solid #28a745;
                }

                .o_kanban_card_available .o_kanban_content {
                    padding: 20px;
                }

                /* Sold Vehicles Card */
                .o_kanban_card_sold {
                    background: linear-gradient(135deg, #fff3cd 0%, #fef8e6 100%);
                    border-left: 4px solid #ffc107;
                }

                .o_kanban_card_sold .o_kanban_content {
                    padding: 20px;
                }

                /* Primary Value Styling */
                .o_dealership_dashboard .o_primary_value {
                    font-size: 3.5rem;
                    font-weight: 700;
                    line-height: 1;
                    margin-bottom: 8px;
                }

                .o_dealership_dashboard .o_secondary_value {
                    font-size: 0.9rem;
                    font-weight: 500;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                }

                /* Record Title Styling */
                .o_dealership_dashboard .o_kanban_record_title {
                    font-size: 1.2rem;
                    font-weight: 600;
                    color: #2c3e50;
                    display: flex;
                    align-items: center;
                }

                /* Details Section */
                .o_dealership_dashboard .o_kanban_details {
                    background: rgba(255,255,255,0.7);
                    border-radius: 8px;
                    padding: 12px;
                    margin: 12px 0;
                }

                .o_dealership_dashboard .o_kanban_detail_item {
                    font-size: 0.85rem;
                    margin-bottom: 4px;
                }

                .o_dealership_dashboard .o_label {
                    font-weight: 600;
                    color: #6c757d;
                }

                /* Footer Styling */
                .o_dealership_dashboard .o_kanban_footer {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                }

                /* Status Badge Customization */
                .o_dealership_dashboard .badge {
                    font-size: 0.75rem;
                    font-weight: 600;
                    padding: 6px 12px;
                    border-radius: 20px;
                    text-transform: capitalize;
                }

                /* Management Button */
                .o_dealership_dashboard .o_kanban_manage_toggle_button {
                    color: #6c757d;
                    font-size: 1.1rem;
                    transition: color 0.2s ease;
                }

                .o_dealership_dashboard .o_kanban_manage_toggle_button:hover {
                    color: #495057;
                }

                /* Management Panel */
                .o_dealership_dashboard .o_kanban_manage_pane {
                    border-radius: 8px;
                    box-shadow: 0 4px 16px rgba(0,0,0,0.15);
                    border: none;
                }

                .o_dealership_dashboard .o_kanban_card_manage_title {
                    color: #495057;
                    font-size: 0.9rem;
                    font-weight: 600;
                    margin-bottom: 8px;
                    padding-bottom: 4px;
                    border-bottom: 1px solid #dee2e6;
                }

                .o_dealership_dashboard .dropdown-item {
                    font-size: 0.85rem;
                    padding: 6px 12px;
                    border-radius: 4px;
                    margin-bottom: 2px;
                }

                .o_dealership_dashboard .dropdown-item:hover {
                    background-color: #f8f9fa;
                }

                /* Responsive Design */
                @media (max-width: 768px) {
                    .o_dealership_dashboard .o_primary_value {
                        font-size: 2.5rem;
                    }
                    
                    .o_dealership_dashboard .o_kanban_content {
                        padding: 15px;
                    }
                }

                /* Group Headers */
                .o_dealership_dashboard .o_kanban_group_header {
                    background: linear-gradient(90deg, #6c757d 0%, #495057 100%);
                    color: white;
                    font-weight: 600;
                    padding: 12px 16px;
                    border-radius: 8px 8px 0 0;
                    margin-bottom: 8px;
                }

                /* Animation for numbers */
                .o_dealership_dashboard .o_value {
                    display: inline-block;
                    animation: fadeInUp 0.6s ease-out;
                }

                @keyframes fadeInUp {
                    from {
                        opacity: 0;
                        transform: translateY(20px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
            </style>
        </xpath>
    </template>

    <!-- Summary Dashboard View (Alternative approach with aggregated data) -->
    <record id="view_dealership_summary_kanban" model="ir.ui.view">
        <field name="name">dealership.vehicle.summary.kanban</field>
        <field name="model">dealership.vehicle</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_dashboard o_dealership_summary_dashboard" create="0" group_create="0">
                <field name="state"/>
                
                <templates>
                    <t t-name="kanban-box">
                        <!-- This would need to be enhanced with computed fields or a different approach -->
                        <!-- for showing aggregated counts across all vehicles -->
                        <div class="o_kanban_record o_kanban_summary_card">
                            <div class="o_kanban_content text-center">
                                <div class="o_summary_icon mb-3">
                                    <i class="fa fa-car fa-3x text-primary"/>
                                </div>
                                <div class="o_summary_title">
                                    Vehicle Inventory Summary
                                </div>
                                <div class="row mt-4">
                                    <div class="col-6">
                                        <div class="o_summary_stat available">
                                            <div class="o_stat_value text-success">
                                                <!-- This would need a computed field -->
                                                <span class="counter">0</span>
                                            </div>
                                            <div class="o_stat_label">Available</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="o_summary_stat sold">
                                            <div class="o_stat_value text-warning">
                                                <!-- This would need a computed field -->
                                                <span class="counter">0</span>
                                            </div>
                                            <div class="o_stat_label">Sold</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Action for the dashboard -->
    <record id="action_dealership_vehicle_dashboard" model="ir.actions.act_window">
        <field name="name">Vehicle Dashboard</field>
        <field name="res_model">dealership.vehicle</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="view_id" ref="view_dealership_vehicle_dashboard_kanban"/>
        <field name="context">{
            'group_by': ['state'],
            'search_default_group_by_state': 1
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No vehicles found!
            </p>
            <p>
                Create your first vehicle record to get started with the dealership management system.
            </p>
        </field>
    </record>

</odoo>